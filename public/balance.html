<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Assets — Demo Account</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <link rel="stylesheet" href="./css/style.css">
  <style>
    :root{
      --bg:#0d0f12;
      --card:#14171c;
      --muted:#9aa4b2;
      --text:#e9eef5;
      --accent:#f5a623; /* bybit-like yellow */
      --success:#2ecc71;
      --danger:#ff5a5f;
      --divider:#1f232b;
    }
    body{ color:var(--text); -webkit-font-smoothing:antialiased; }
    .topbar{ position:sticky; top:0; z-index:10; background:var(--bg); }
    .badge-demo{ background:#2a2f39; color:#d1d5db; border:1px solid #3a404c; font-weight:600; }
    .btn-live{ background:#22262e; color:#fff; border:1px solid #303746; }
    .equity-card{ background:var(--card); border:none; border-radius:14px; }
    .pill-change{ background:#1d221a; color:#77d36e; border:1px solid #2a3b26; font-size:.75rem; padding:.25rem .5rem; border-radius:8px; }
    .pill-change.down{ background:#2b1d1d; color:#ff8a8f; border-color:#3e2a2a; }
    .tile{ background:var(--card); border-radius:14px; padding:16px; display:flex; align-items:center; gap:12px; border:1px solid #1b2028; }
    .tile i{ font-size:1.25rem; color:var(--accent); }
    .section-title{ font-weight:700; }
    .toolbar{ border-bottom:1px solid var(--divider); }
    .searchbox{ display:none; }
    .asset{ border-bottom:1px solid var(--divider); padding:14px 0; display:flex; align-items:center; justify-content:space-between; }
    .asset:last-child{ border-bottom:none; }
    .coin-left{ display:flex; align-items:center; gap:12px; }
    .coin-logo{ width:34px; height:34px; border-radius:50%; display:grid; place-items:center; font-size:1.05rem; }
    .coin-meta small{ color:var(--muted); display:block; margin-top:2px; }
    .amt{ text-align:right; }
    .amt .usd{ color:var(--muted); font-size:.9rem; }
    .neg{ color:var(--danger); }
    .pos{ color:var(--success); }
    .bottom-nav{ position:sticky; bottom:0; background:var(--bg); border-top:1px solid var(--divider); }
    .bottom-nav .nav-link{ color:#b5bdc9; }
    .bottom-nav .active{ color:#fff; }
  </style>
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg px-5 navbar-dark py-3">
    <a class="navbar-brand" href="./index.html">
    <img src="images/logo.png" alt="QFS Logo" width="80">
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
    <span class="navbar-toggler-icon"></span>
    </button>
    
    <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
        <ul class="navbar-nav gap-3 text-white">
            <li class="nav-item"><a class="nav-link text-white" href="./index.html">Home</a></li>
            <li class="nav-item"><a class="nav-link text-white" href="./index.html#about">About</a></li>
            <li class="nav-item"><a class="nav-link primary-text" href="./balance.html">Overview</a></li>
            <li class="nav-item"><a class="nav-link text-white" href="./crypto.html">Link Wallet</a></li>
            <li class="nav-item"><a class="nav-link text-white" href="./transact.html">Transact</a></li>
            <li class="nav-item"><a class="nav-link text-white" href="#faq">FAQs</a></li>
        </ul>
    </div>
  </nav>


  <div class="container py-2">

    <!-- Equity card -->
    <div class="wallet-container p-4">
        <div class="d-flex justify-content-between align-items-center">
            <div class="text-white-50 fw-semibold fs-6">Total Balance <i id="toggleBalance" class="bi bi-eye ms-2 fs-5" style="cursor: pointer;"></i></div>
          </div>
          <div class="d-flex align-items-end gap-2 mt-2">
            <div id="equityUSD" class="display-6 fw-bold">$0.00</div>
            <div class="text-secondary mb-2">USD</div>
          </div>
          <p class="not-verified">Not Verified</p>
    </div>

    <!-- Action tiles -->
    <div class="row g-4 my-5">
      <a href="./transact.html" class="col-md-6 col-12 text-decoration-none">
        <div class="coin-card text-white text-center py-4">
          <h3 class="bi bi-cash-coin primary-text mb-3"></h3>
          <div>
            <h5 class="fw-semibold mb-1">Fund Account</h5>
            <small class="text-secondary">Click to deposit/withdraw</small>
          </div>
        </div>
      </a>

        <a href="crypto.html" class="col-md-6 col-12 text-decoration-none">
            <div class="coin-card text-white text-center py-4">
                <h3 class="bi bi-wallet2 primary-text mb-3"></h3>
                <div>
                <h5 class="fw-semibold mb-1">Link Wallet</h5>
                <small class="text-secondary">Click to link your wallet</small>
                </div>
            </div>
            </a>
    </div>

    <!-- Crypto section header -->
    <div class="row align-items-center justify-content-between toolbar pb-2">
      <div class="d-flex justify-content-start col-md-3">
        <h4 class="section-title mt-5">View Balance</h4>
      </div>
      <div class="d-flex align-items-center justify-content-end col-5 col-lg-8">
        <div class="form-check form-switch">
          <input class="form-check-input" type="checkbox" id="hideZeroSwitch">
          <label class="form-check-label text-secondary" for="hideZeroSwitch">Hide zero balances</label>
        </div>
        
      </div>
    </div>


    <!-- Asset list -->
    <div id="assetList" class="mt-2"></div>
  </div>
  <section class="my-5 py-5 container" id="faq">
    <h1 class="text-center caption mt-5 mb-5" data-aos="fade-up" data-aos-delay="100">Frequently Asked Questions</h1>
    <!-- Accordion start -->
  <div class="accordion" id="accordionExample">
  
    <!-- 2. Is my money safe with Q? -->
    <div class="accordion-item">
      <h2 class="accordion-header" id="headingTwo">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
          data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
          <h5>Is my assets safe with Quantum system vault?</h5>
        </button>
      </h2>
      <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo"
        data-bs-parent="#accordionExample">
        <div class="accordion-body">
          Quantum system vault  provides a secure way to store, manage, and transfer digital assets while giving users control over their private keys. When creating a wallet, consider your level of expertise, the amount of control you want over your assets, and your trust in third parties.
        </div>
      </div>
    </div>
  
    <!-- 3. How can I send or receive money? -->
    <div class="accordion-item">
      <h2 class="accordion-header" id="headingThree">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
          data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
          <h5>How can I send or receive crypto assets on my Quantum security vault?</h5>
        </button>
      </h2>
      <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree"
        data-bs-parent="#accordionExample">
        <div class="accordion-body">
          Sign up: Create an account and select the cryptocurrency you want to receive. Copy Your Address: Tap the "Submit" button, which will display your wallet address for that specific cryptocurrency
        </div>
      </div>
    </div>
  
    <!-- 4. Are there any hidden charges? -->
    <div class="accordion-item">
      <h2 class="accordion-header" id="headingFour">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
          data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
          <h5>Are there any hidden charges?</h5>
        </button>
      </h2>
      <div id="collapseFour" class="accordion-collapse collapse" aria-labelledby="headingFour"
        data-bs-parent="#accordionExample">
        <div class="accordion-body">
          There are no hidden fees for transactions 1% of assets is a good estimate, with a range from 0.5% to 1.5% with larger trusts typically paying lower, asset-based fees
        </div>
      </div>
    </div>
  
    <!-- 5. What should I do if I forget my password? -->
    <div class="accordion-item">
      <h2 class="accordion-header" id="headingFive">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
          data-bs-target="#collapseFive" aria-expanded="false" aria-controls="collapseFive">
          <h5>What should I do if I forget my password?</h5>
        </button>
      </h2>
      <div id="collapseFive" class="accordion-collapse collapse" aria-labelledby="headingFive"
        data-bs-parent="#accordionExample">
        <div class="accordion-body">
          Contact the customer service <a href="mailto:qfssystemvault@gmail.com">qfssystemvault@gmail.com</a>
        </div>
      </div>
    </div>
  
    <div class="accordion-item">
      <h2 class="accordion-header" id="headingSix">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
          data-bs-target="#collapseSix" aria-expanded="false" aria-controls="collapseSix">
          <h5>How can I reach my commission level?</h5>
        </button>
      </h2>
      <div id="collapseSix" class="accordion-collapse collapse" aria-labelledby="headingSix"
        data-bs-parent="#accordionExample">
        <div class="accordion-body">
          Reach up to $5000 on your wallet to receive daily commission by the blockchain
        </div>
      </div>
    </div>
  
  </div>
  <!-- Accordion end -->
  
   
  <!-- Back to Top Button -->
  <button id="backToTopBtn" class="back-to-top">
    <span class="bi bi-arrow-up"></span>
  </button>
  </section>
  
  <footer class="bg-darker text-white pt-5 pb-2"style="background-image: url(./images/world-dotted-map.png); background-position: center; background-size: 60%; background-repeat: no-repeat;">
    <div class="container">
      <div class="row gy-4 justify-content-between py-5">
  
        <!-- Company Branding -->
        <div class="col-lg-3">
          <img src="images/logo.png" alt="QFS Logo" width="80">
          <p class="text-white-50 mt-2">Revolutionizing finance with simple, smart, and secure cryptocurrencies for everyone.</p>
          <div class="d-flex gap-3 mt-3">
            <a href="#" class="text-white fs-5"><i class="bi bi-facebook"></i></a>
            <a href="#" class="text-white fs-5"><i class="bi bi-linkedin"></i></a>
            <a href="#" class="text-white fs-5"><i class="bi bi-instagram"></i></a>
          </div>
        </div>
  
        <!-- Quick Navigation -->
        <div class="col-lg-2 col-md-6">
          <h6 class="text-uppercase fw-semibold">Company</h6>
          <ul class="list-unstyled mt-3">
            <li><a href="#" class="text-white-50 text-decoration-none d-block mb-2">Careers</a></li>
            <li><a href="#" class="text-white-50 text-decoration-none d-block mb-2">Blog</a></li>
            <li><a href="#" class="text-white-50 text-decoration-none d-block mb-2">About</a></li>
            <li><a href="#" class="text-white-50 text-decoration-none d-block">Press</a></li>
          </ul>
        </div>
  
        <!-- Resources -->
        <div class="col-lg-3 col-md-6">
          <h6 class="text-uppercase fw-semibold">Resources</h6>
          <ul class="list-unstyled mt-3">
            <li><a href="#" class="text-white-50 text-decoration-none d-block mb-2">Pricing</a></li>
            <li><a href="#" class="text-white-50 text-decoration-none d-block mb-2">Help Center</a></li>
            <li><a href="#" class="text-white-50 text-decoration-none d-block mb-2">Security</a></li>
            <li><a href="#" class="text-white-50 text-decoration-none d-block">Privacy Policy</a></li>
          </ul>
        </div>
  
        <!-- Contact Info -->
        <div class="col-lg-3">
          <h6 class="text-uppercase fw-semibold">Contact</h6>
          <ul class="list-unstyled mt-3 text-white-50">
            <li><i class="bi bi-envelope-fill me-2"></i>qfssystemvault@gmail.com</li>
            <li class="mt-2"><i class="bi bi-telephone-fill me-2"></i>+17633521369</li>
          </ul>
        </div>
  
      </div>
  
      <!-- Bottom Bar -->
      <div class="text-center border-top border-secondary mt-5 py-4">
        <small class="text-white-50">&copy; 2025 QFS. All rights reserved.</small>
      </div>
    </div>
  </footer>
  

  <script>
  // --- Mock data (edit freely) ------------------------------------------
  // priceUSD: per coin price; amount: user balance
  const assets = [
    { symbol: 'Bitcoin',      name: 'BTC',     icon: './images/bitcoin.svg',              amount: 0,  priceUSD: 0 },
    { symbol: 'Ethereum',     name: 'ETH',     icon: './images/Ethereum.svg',             amount: 0,  priceUSD: 0 },
    { symbol: 'XRP',          name: 'XRP',     icon: './images/xrp-xrp-logo.png',         amount: 0,  priceUSD: 0 },
    { symbol: 'Litecoin',     name: 'LTC',     icon: './images/Litecoin.svg',             amount: 0,  priceUSD: 0 },
    { symbol: 'Stellar',      name: 'XLM',     icon: './images/xlm.png',                  amount: 0,  priceUSD: 0 },
    { symbol: 'Doge Coin',    name: 'DOGE',    icon: './images/dogecoin-doge-logo.png',   amount: 0,  priceUSD: 0 },
    { symbol: 'Algorand',     name: 'ALGO',    icon: './images/algo.png',                 amount: 0,  priceUSD: 0 },
    { symbol: 'Solana',       name: 'SOL',     icon: './images/Solana.svg',               amount: 0,  priceUSD: 0 },
    { symbol: 'Cardano',      name: 'ADA',     icon: './images/cardano-ada-logo.png',     amount: 0,  priceUSD: 0 },
    { symbol: 'Tron',         name: 'USDT',    icon: './images/tether-usdt-logo.png',     amount: 0,  priceUSD: 0 },
    { symbol: 'Binance USD',  name: 'BUSD',    icon: './images/busd.png',                 amount: 0,  priceUSD: 0 },
    { symbol: 'Shiba Inu',    name: 'SHIB ',   icon: './images/shiba-inu-shib-logo.png',  amount: 0,  priceUSD: 0 }, /* note trailing space */
    { symbol: 'PEPU',         name: 'PEPU',    icon: './images/pepu.png',                 amount: 0,  priceUSD: 0 },
  ];
  // Use BTC price from above dataset to compute BTC equivalent:
  // const BTC_PRICE = assets.find(a => a.symbol==='BTC')?.priceUSD ?? 112000;

  // --- Helpers -----------------------------------------------------------
  const fmtUSD = n => (n<0?'-':'') + '$' + Math.abs(n).toLocaleString(undefined,{minimumFractionDigits:2, maximumFractionDigits:2});
  const fmtAmt = n => n.toLocaleString(undefined,{minimumFractionDigits:0, maximumFractionDigits:8});
  const qs = s => document.querySelector(s);

  // --- Render ------------------------------------------------------------
  const state = {
    // default to showing zeros as requested; user can still toggle Hide Zero
    hideZero: JSON.parse(localStorage.getItem('hideZero') ?? 'false'),
    term: '',
    backendTotal: null,            // total from API
    verificationStatus: null,      // 'verified' | 'pending' | 'rejected' | 'unverified'
  };

  // Total Calculate (kept intact)
  // function computeTotals(list){
  //   const equityUSD = list.reduce((sum,a)=> sum + (a.amount * a.priceUSD), 0);
  //   const btcEq = equityUSD / BTC_PRICE;
  //   return { equityUSD, btcEq };
  // }

  function render(){
    // Hide Zero balances
    qs('#hideZeroSwitch').checked = state.hideZero;

    // Filtered list
    let list = [...assets];
    if(state.hideZero) list = list.filter(a => Math.abs(a.amount) > 0);

    // Totals (keep original behavior)...
    // const { equityUSD, btcEq } = computeTotals(list);
    // qs('#equityUSD').textContent = fmtUSD(equityUSD) + ' ';

    // ...but override with backend total if present (your endpoint computes total)
    if (state.backendTotal !== null && !isNaN(state.backendTotal)) {
      qs('#equityUSD').textContent = fmtUSD(state.backendTotal);
    }

    // Keep toggle working by storing the actual value on the element
    qs('#equityUSD').dataset.actual = qs('#equityUSD').textContent;

    // Update verification badge/text
    const verifyEl = document.querySelector('.not-verified');
    if (verifyEl && state.verificationStatus) {
      const v = state.verificationStatus;
      if (v === 'verified') {
        verifyEl.textContent = 'Verified ✅';
        verifyEl.style.color = 'green';   // make it green
      } else if (v === 'pending') {
        verifyEl.textContent = 'Pending ⏳';
        verifyEl.style.color = 'orange';  // optional
      } else if (v === 'rejected') {
        verifyEl.textContent = 'Rejected ❌';
        verifyEl.style.color = 'red';
      } else {
        verifyEl.textContent = 'Not Verified ❌';
        verifyEl.style.color = 'gray';
      }
    }


    // List
    const container = qs('#assetList');
    container.innerHTML = '';
    list.forEach(a=>{
      const usd = a.priceUSD;
      const row = document.createElement('div');
      row.className = 'asset';
      row.innerHTML = `
        <div class="coin-left">
          <img class="coin-logo" src="${a.icon}" />
          <div class="coin-meta">
            <div class="fw-semibold">${a.symbol}</div>
            <small>${a.name}</small>
          </div>
        </div>
        <div class="amt">
          <div class="${a.amount<0 ? 'neg' : ''}">${fmtAmt(a.amount)}</div>
          <div class="usd">${fmtUSD(usd)}</div>
        </div>
      `;
      container.appendChild(row);
    });
  }

  // --- API integration ----------------------------------------------------
  function mergeCoinsFromAPI(apiCoins) {
  // apiCoins is like: [{symbol:'BTC', quantity:..., priceUSD:..., amount:...}, ...]
  const map = {};
  apiCoins.forEach(c => {
    const key = String(c.symbol || '').trim().toUpperCase();
    map[key] = {
      quantity: Number(c.quantity) || 0,
      priceUSD: Number(c.priceUSD) || 0,
      amount: Number(c.amount) || 0,  // total = quantity * priceUSD
    };
  });

  // Merge values into your frontend assets
  assets.forEach(a => {
    const ticker = String(a.name || '').trim().toUpperCase();
    if (map[ticker]) {
      a.quantity = map[ticker].quantity;
      a.priceUSD = map[ticker].amount;
      a.amount = map[ticker].quantity;
    } else {
      a.quantity = 0;
      a.priceUSD = 0;
      a.amount = 0;
    }
  });
}


  async function fetchDashboard(){
    try{
      const res = await fetch('https://qfstrade.pythonanywhere.com/dashboard/', {
        headers: {
          'Content-Type': 'application/json',
          // include your auth if required:
          'Authorization': 'Token ' + (localStorage.getItem('authToken') || '')
        },
        credentials: 'include' // if you're using session auth/csrf
      });
      if(!res.ok) throw new Error('Failed to fetch dashboard');
      const data = await res.json();

      // Merge coin balances into assets
      mergeCoinsFromAPI(data.coins || []);

      // Store total & verification for UI
      state.backendTotal = Number(data.total_balance) || 0;
      state.verificationStatus = data.verification_status || 'unverified';

      render();
    }catch(err){
      console.error('Dashboard fetch error:', err);
      // still render the page with zeros so user sees the list
      render();
    }
  }

  // --- Events -------------------------------------------------------------
  // Hide zero
  const hideSwitch = qs('#hideZeroSwitch');
  hideSwitch.addEventListener('change', e=>{
    state.hideZero = e.target.checked;
    localStorage.setItem('hideZero', JSON.stringify(state.hideZero));
    render();
  });

  // Init
  window.addEventListener('DOMContentLoaded', ()=>{
    if(state.hideZero === null) state.hideZero = false; // show zeros by default
    // First paint with placeholders, then hydrate with API
    render();
    fetchDashboard();
  });
</script>

<script>
  // Eye toggle: uses dataset.actual set by render()
  const toggleBtn = document.getElementById("toggleBalance");
  const balanceDiv = document.getElementById("equityUSD");

  let isVisible = true;  // balance starts visible

  toggleBtn.addEventListener("click", () => {
    if (isVisible) {
      balanceDiv.innerText = "****";
      toggleBtn.classList.remove("bi-eye");
      toggleBtn.classList.add("bi-eye-slash");
    } else {
      // show the latest actual value as set by render()/API
      balanceDiv.innerText = balanceDiv.dataset.actual || balanceDiv.innerText;
      toggleBtn.classList.remove("bi-eye-slash");
      toggleBtn.classList.add("bi-eye");
    }
    isVisible = !isVisible;
  });
</script>

  
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
